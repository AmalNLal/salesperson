# Salesperson | Concorde | LK algorithm - Installation Instructions

## Salesperson
```
git clone <repo>
cd salesperson/bin

#if not already executable
chmod +x ./install.sh

./install.sh
```
Solvers won't be installed as the source repo (repo that contains the solver files) are private, and we also don't need all of the solvers.

## Concorde & LK Algorithms
Download the Concorde Files [Concorde-03.12.19](https://www.math.uwaterloo.ca/tsp/concorde/downloads/codes/src/co031219.tgz)
```
cd <folder containing concorde file(prefered if it's in the same folder as salesperson)>
gunzip co031219.tgz
tar xvf co031219.tar
cd concorde
mkdir QSOPT
```
Download Linear Programming solver [qsopt](https://www.math.uwaterloo.ca/~bico/qsopt/downloads/downloads.htm) download all files under MacOS or ubuntu.
Store all the qsopt files inside QSOPT folder.

Make sure you have C compiler installed.
`gcc --version`

Compile concorde - make sure you are in concorde folder
```
export CFLAGS="-g -O3"
./configure --with-qsopt= /home/full/path/to/concorde/QSOPT
make
```

Now, copy the linkern executable file from newly created LINKERN folder and paste it in the newly created TSP. Now we have both concorde and linkern executables in the same folder.

## Testing with R code
```r
library('salesperson')
testing <- salesperson::generateRandomNetwork(50,name="Testing")
exportToTSPlibFormat(testing, "testing.tsp","testing")

library(TSP)
testing.distance_matix<- TSP(dist(testing$coordinate))
concorde_path("/home/full/path/to/concorde/TSP")
concorde_help()
linkern_help()

solutionlk <- solve_TSP(testing.distance_matix, method = "linkern")
solutionconcorde <- solve_TSP(testing.distance_matix, method = "concorde")
```


Sample output
```
> solutionlk <- solve_TSP(testing.distance_matix, method = "linkern")
Used control parameters by ‘NA’ 
exe	 =  /home/full/path/to/concorde/TSP/linker
clo	 =  
precision	 =  6
verbose	 =  TRUE
keep_files	 =  FALSE

Host: virtual-machine  Current process id: 24315
/home/full/path/to/concorde/TSP/linkern -o file58fc285d046d.sol file58fc285d046d.dat
Chained Lin-Kernighan with seed 1705547854
Problem Name: TSP
Generated by write_TSPLIB (R-package TSP)
Problem Type: TSP
Number of Nodes: 50
Explicit Lengths (CC_MATRIXNORM)
Using junk-norm nearest code
 244 edges
Time to find 8 nearest: 0.00
Grow a Quick-Boruvka tour 
Length of Quick-Boruvka Tour: 695.00
Time to grow tour: 0.00
linkern ...
Starting Cycle: 695
   0 Steps   Best: 578   0.00 seconds
   1 Steps   Best: 574   0.00 seconds
   2 Steps   Best: 565   0.00 seconds
  50 Total Steps.
Best cycle length: 565
Lin-Kernighan Running Time: 0.01
Final Cycle: 565
Total Running Time: 0.01


> solutionconcorde <- solve_TSP(testing.distance_matix, method = "concorde")
Used control parameters by ‘NA’ 
clo	 =  
exe	 =  /home/full/path/to/concorde/TSP/concor
precision	 =  6
verbose	 =  TRUE
keep_files	 =  FALSE

/home/full/path/to/concorde/TSP/concorde -x -o file58fc42c063ef.sol file58fc42c063ef.dat
Host: virtual-machine  Current process id: 24321
Using random seed 1705547927
Problem Name: TSP
Generated by write_TSPLIB (R-package TSP)
Problem Type: TSP
Number of Nodes: 50
Explicit Lengths (CC_MATRIXNORM)
Set initial upperbound to 565 (from tour)
  LP Value  1: 532.500000  (0.00 seconds)
  LP Value  2: 554.000000  (0.00 seconds)
  LP Value  3: 564.666667  (0.01 seconds)
  LP Value  4: 565.000000  (0.01 seconds)
New lower bound: 565.000000
Final lower bound 565.000000, upper bound 565.000000
Exact lower bound: 565.000000
DIFF: 0.000000
Final LP has 79 rows, 111 columns, 574 nonzeros
Optimal Solution: 565.00
Number of bbnodes: 1
Total Running Time: 0.04 (seconds)
```
